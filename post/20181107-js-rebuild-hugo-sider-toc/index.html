<!DOCTYPE html>
<html>



  <meta charset="UTF-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1.0, user-scalable=no" >

  
  
    
    <meta charset="utf-8" name="keywords" content="JavaScript,hugo å¯¼èˆªæ ,TOC,å»ºç«™,ä¾§è¾¹å¼¹å‡º,æ ‘," > 
  
   
  <meta charset="utf-8" name="description" content="æœ¬æ–‡ä¸»è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š


æ§åˆ¶ hugo TOC å±•ç°å±‚æ¬¡ï¼Œå¦‚åªæ˜¾ç¤ºå‰3å±‚
ç¾åŒ– hugo TOC æ ·å¼
é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°
é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥
ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ


ç›¸å…³ä¸»ä½“ä»£ç åœ°å€ï¼šhttps://gist.github.com/yidaofeicn/1575ee1fb853f5281f535e72b0fa8d91
å…·ä½“æ•ˆæœç‚¹å‡»å³è¾¹çš„é”šç‚¹æŒ‰é’®å°±å¯ä½“éªŒ
" >
  
  
  
    
        <link rel="icon" type="image/png" href="https://yidaofei.com//image/favicon-32x32.png" > 
    
  
  
  
  
  <title>JavaScript-é‡å»º hugo ä¾§è¾¹å¯¼èˆªæ  TOC- æ˜“é“é Blog</title>  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-144198262-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  


  
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="https://yidaofei.com//css/style.css">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script> 
<body> 
 

 
<div id="top-element" data-title="åˆ°è¾¾é¡¶ç‚¹"></div>
  
<header class="site-header fixed-top">
  <div class="container">
    <nav id="navigation">  
      <a href="https://yidaofei.com/" class="site-title">
        
        <img title="site-logo" class="site-logo" src="https://yidaofei.com//image/logo.png" >
           
         æ˜“é“é Blog 
      </a> 
      <a aria-label="mobile menu" class="nav-toggle" id="site-nav-toggle"> 
        <span></span> <span></span> <span></span> 
      </a>
      <ul class="menu-left">
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/tags">Tags</a></li>
        
          <li><a href="/wiki">Wiki</a></li>
        
          <li><a href="/about">About</a></li>
        

        
          <li><a data-remodal-target="searchinput">search</a></li>
           
      </ul>
    </nav>
  </div>
</header> 



<div class="remodal" data-remodal-id="searchinput" role="dialog" aria-labelledby="modal1Title" aria-describedby="modal1Desc"> 
  <span id="algoliaData" style="display:none;" data-appid="NYC6MHRISW" 
		data-searchkey="7f131a263a8820645ee9fc65ed97b22f" 
		data-initindex="github-yidaofeicnBlog"></span>

<div class="search-input-card" >
    <input type="search" id="search-input" class="search-input" placeholder="Search for titles or URIs..." name="search" autocomplete="off" />
     <span class="input-search-icon"><i class="fa fa-search"></i></span> 
</div>

 

  
</div>

  



<section class="main-content-container">
<article class="article-card">
	<header class="article-header"> 
	   <p class="article-title">JavaScript-é‡å»º hugo ä¾§è¾¹å¯¼èˆªæ  TOC</p>
   		<div class="article-meta">
			
			<div><i class="fa fa-calendar" >2018å¹´10æœˆ07æ—¥</i> </div>
			  

			 
			<div>
				
					<i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span>&nbsp;read 
	            
			</div>  
			 
			<div>
				&nbsp;&nbsp;<i class="fa fa-th">&nbsp;Categories:
				
					<a href="https://yidaofei.com/categories/javascript">JavaScript</a> 
				   
				</i>  
			</div> 
		</div>  
	</header>  
	<content class="markdown">
		<p>æœ¬æ–‡ä¸»è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>

<ol>
<li>æ§åˆ¶ hugo TOC å±•ç°å±‚æ¬¡ï¼Œå¦‚åªæ˜¾ç¤ºå‰3å±‚</li>
<li>ç¾åŒ– hugo TOC æ ·å¼</li>
<li>é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°</li>
<li>é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥</li>
<li>ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ</li>
</ol>

<p>ç›¸å…³ä¸»ä½“ä»£ç åœ°å€ï¼š<a href="https://gist.github.com/yidaofeicn/1575ee1fb853f5281f535e72b0fa8d91">https://gist.github.com/yidaofeicn/1575ee1fb853f5281f535e72b0fa8d91</a>
å…·ä½“æ•ˆæœç‚¹å‡»<strong>å³è¾¹çš„é”šç‚¹æŒ‰é’®</strong>å°±å¯ä½“éªŒ
</p>

<h3 id="hugo-toc-åŸæœ‰æ ·å¼">Hugo TOC åŸæœ‰æ ·å¼</h3>

<p><img src="http://136.244.110.202/galleries/201811/hugo-toc.png" alt="hugo TOC åŸæœ‰æ ·å¼" /></p>

<h3 id="æ§åˆ¶-hugo-toc-å±•ç°å±‚æ¬¡">æ§åˆ¶ Hugo TOC å±•ç°å±‚æ¬¡</h3>

<h4 id="ç¬¬ä¸€è§£å†³æ–¹æ¡ˆ-è‡ªå»ºæ•°æ®èŠ‚ç‚¹-é€’å½’ç®—æ³•">ç¬¬ä¸€è§£å†³æ–¹æ¡ˆâ€”â€”è‡ªå»ºæ•°æ®èŠ‚ç‚¹ï¼Œé€’å½’ç®—æ³•</h4>

<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://linuxer.io/posts/hugo-toc/">https://linuxer.io/posts/hugo-toc/</a> è°ƒæ•´ï¼ˆé“¾æ¥ä¼¼ä¹å¤±æ•ˆ ğŸ˜±ï¼‰</p>

<ol>
<li>å°†å…ƒç´ æ•°æ®æŠ½ç¦»ï¼Œç»„åˆæˆç±»ä¼¼ æ ‘çš„æ•°æ®ç»“æ„</li>
<li>å¾ªç¯å¤„ç†é‡æ–°ç»„åˆæˆç›¸å…³çš„ DOM ç»“æ„ï¼Œä¸­é—´æ’å…¥ç›¸å…³çš„æ•°æ®</li>
</ol>

<p>å…³é”®ä»£ç  JavaScript å¦‚ä¸‹ï¼š</p>

<pre><code class="language-javascript">/*
@param rootDomï¼šæ ¹dom 
*/
function iterativeSplit(rootDom){
  var liTagList=[];
  $(rootDom).children(&quot;li&quot;).each(function(i, item) {
        var liTag = { 
            url: $(item).children(&quot;a&quot;).attr(&quot;href&quot;), 
            name: $(item).children(&quot;a&quot;).text(),
            children: []
        }   
        $subUlTag = $(item).children(&quot;ul&quot;);
        if ($subUlTag.length &gt; 0) {
            liTag.children = iterativeSplit($subUlTag);
        }   
        liTagList.push(liTag);
    })  
    return liTagList;
}


/*
TOCé€’å½’åˆæˆæ¨¡æ¿ 
@param rootï¼šæ•°æ®çš„èµ·å§‹ç‚¹
@param templateï¼šåˆæˆHTMLæ¨¡æ¿
@param SNPrefixï¼šåºå·å‰ç¼€ 
@param startLevelï¼šå¼€å§‹å¤„ç†å±‚æ¬¡ï¼Œä»¥rootå±•å¼€å±‚æ¬¡ä¸ºæ ‡å‡†
@param endLevel:æœ€å¤§å¤„ç†å±‚æ¬¡ï¼Œæ•°å€¼æœ€å¤§ä¸º6æˆ–è€…æ˜¯rootæœ€æ·±çš„å±‚
@param currentLevelï¼šæ­£å¤„ç†å±‚æ¬¡
*/
function iterativeCreate(root,template,SNPrefix,startLevel,endLevel,currentLevel){
    //å¦‚éœ€å¤„ç†å±‚æ¬¡ä¸åœ¨å¤„ç†èŒƒå›´ï¼Œæˆ–è€…æ— å­å…ƒç´ ç›´æ¥è¿”å›
    if(currentLevel&gt;endLevel||$(root).children.length&lt;0){
        return template;
    }
    //å¼€å§‹å¤„ç†ç›¸å…³æ•°æ®
    if(startLevel&lt;=currentLevel&amp;&amp;currentLevel&lt;=endLevel){
        template += '&lt;ul&gt;' 
    }
    $.each(root, function(index, tocItem) {
      if(startLevel&lt;=currentLevel&amp;&amp;currentLevel&lt;=endLevel){
        var nextSNPrefix=&quot;&quot;;
        //å¤„ç†å‰ç¼€
        if(tocItem.name!=&quot;&quot;){
          nextSNPrefix = SNPrefix + String(index+1) + &quot;.&quot; ;
          if(endLevel==currentLevel){
              nextSNPrefix = SNPrefix + String(index+1);
          }
          template += '&lt;li&gt;'+ 
                            '&lt;a href=&quot;navURL&quot;&gt;&lt;b&gt;navSerial  &lt;/b&gt;navName&lt;/a&gt;'
                               .replace(&quot;navURL&quot;, tocItem.url)
                               .replace(&quot;navName&quot;, tocItem.name)
                               .replace(&quot;navSerial&quot;, nextSNPrefix) +
                        '&lt;/li&gt;';
        } 
      } 
      if (tocItem.children.length &gt; 0) { 
          if(startLevel&lt;=currentLevel&amp;&amp;currentLevel&lt;=endLevel){  
            template = iterativeCreate(tocItem.children, template, nextSNPrefix,startLevel,endLevel,currentLevel+1);
          }else{ 
            template = iterativeCreate(tocItem.children, template, SNPrefix,startLevel,endLevel,currentLevel+1);
          }
       }   
    }); 
    if(template.length&gt;0){
         template += &quot;&lt;/ul&gt;&quot;;   
         return template;
    } 
    
}
</code></pre>

<p>æœ€ç»ˆå‘ˆç°çš„æ ·å¼ä¸ºï¼š</p>

<p><img src="http://136.244.110.202/galleries/201811/adjust-hugo-toc.png" alt="é‡å»º hugo " /></p>

<h4 id="20181108-åºå·é”™ä¹±">20181108 åºå·é”™ä¹±</h4>

<p>ä»¥ä¸Šç‰ˆæœ¬æ˜¯å¦è§£å†³å…¨éƒ¨é—®é¢˜ï¼Ÿåœ¨ hugo ç¼–å†™å†…å®¹çš„è¿‡ç¨‹ä¸­å‘ç°æœ‰ä»¥ä¸‹éœ€æ±‚ï¼š</p>

<ul>
<li>å¦‚ç‰¹å®šéœ€æ±‚â€”â€”*åªéœ€è¦*å±•ç¤ºç¬¬2å±‚-ç¬¬3å±‚æ ‡é¢˜ï¼Œè°ƒç”¨ä»£ç <code>var html=iterativeCreate(root,&quot; &quot;,' ',2,3,0);</code></li>
</ul>

<p>åœ¨æ­¤æƒ…å†µä¸‹ä¼šå‡ºç°åºå·é”™ä¹±æƒ…å†µå¦‚ä¸‹ï¼š</p>

<p><img src="http://136.244.110.202/galleries/201811/sn-error-adjust-hugo-toc.png" alt="é‡å»º hugo åºå·é”™è¯¯" /></p>

<p>åˆ†æä¸»è¦é—®é¢˜æ˜¯å‡ºç°åœ¨é€’å½’è°ƒç”¨å˜é‡æ ˆæ•°æ® <code>nextSNPrefix</code> é€šä¿¡é—®é¢˜ï¼Œç»“æ„ç®€åŒ–åˆ†æ</p>

<pre><code class="language-html">&lt;ul&gt;
  &lt;li&gt;&lt;/li&gt;-----------------ç¬¬ä¸€å±‚æ ‡é¢˜
  &lt;li&gt;
    &lt;ul&gt;--------------------ç¬¬1éƒ¨åˆ†
      &lt;li&gt;------------------ç¬¬äºŒå±‚æ ‡é¢˜  é€’å½’è°ƒç”¨ SNPrefix='' , å‡½æ•°å†…éƒ¨é€»è¾‘ï¼šnextSNPrefix 1
        &lt;ul&gt;
          &lt;li&gt;&lt;/li&gt;---------ç¬¬ä¸‰å±‚æ ‡é¢˜  é€’å½’è°ƒç”¨ SNPrefix='1', å‡½æ•°å†…éƒ¨é€»è¾‘ï¼šnextSNPrefix 1.1
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;/li&gt;-------------ç¬¬äºŒå±‚æ ‡é¢˜  é€’å½’è°ƒç”¨ SNPrefix='' , å‡½æ•°å†…éƒ¨é€»è¾‘ï¼šnextSNPrefix 1.1
    &lt;/ul&gt; 
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;--------------------ç¬¬2éƒ¨åˆ†
      &lt;li&gt;------------------ç¬¬äºŒå±‚æ ‡é¢˜  é€’å½’è°ƒç”¨ SNPrefix='' , å‡½æ•°å†…éƒ¨é€»è¾‘ï¼šnextSNPrefix 1
        &lt;ul&gt;
          &lt;li&gt;&lt;/li&gt;---------ç¬¬ä¸‰å±‚æ ‡é¢˜ 
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;/li&gt;-------------ç¬¬äºŒå±‚æ ‡é¢˜
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre>

<h4 id="ç¬¬äºŒè§£å†³æ–¹æ¡ˆ-åˆ©ç”¨-html-dom">ç¬¬äºŒè§£å†³æ–¹æ¡ˆ-åˆ©ç”¨ HTML DOM</h4>

<p>é—®é¢˜ä¸»è¦æ˜¯ç”±äºè°ƒç”¨è¿‡ç¨‹ä¸­ç¬¬1éƒ¨åˆ†ä¸ç¬¬2éƒ¨åˆ†å¤„äºä¸åŒçš„å±‚æ¬¡å¯¼è‡´ï¼Œæ‰€ä»¥æ–¹æ³•å°±æ˜¯å°†ç¬¬1éƒ¨åˆ†ä¸ç¬¬2éƒ¨åˆ†æŠ½è°ƒå‡ºæ¥æ”¾å…¥åŒä¸€ä¸ªå±‚æ¬¡å³å¯</p>

<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>

<ol>
<li>åˆ©ç”¨ Hugo å»ºç«‹çš„ TOC ç»“æ„ï¼ŒæŠ½å–å¯¹åº”çš„ç»“æ„ï¼Œä¸»è¦å¤„ç† å¼€å§‹èŠ‚ç‚¹ï¼Œç»“æŸèŠ‚ç‚¹å¯ä»¥åœ¨å¤„ç†å†…å®¹æ—¶æœŸå¤„ç†</li>
<li>å¤„ç†æŠ½å–å‡ºæ¥çš„ç»“æ„-å¦‚èµ‹å€¼ï¼ŒåŠ æ ·å¼ç­‰</li>
</ol>

<p>ç›¸æ¯”è¾ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬è€Œè¨€ä»£ç å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>

<ol>
<li>å¯é˜…è¯»æ€§æ›´é«˜ï¼Œé€’å½’ç®—æ³•ï¼Œå˜é‡è¿½è¸ªéš¾</li>
<li>å†…å­˜å¼€é”€é™ä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜æ˜¾é™ä½</li>
<li>åˆ©ç”¨ HTML DOM èŠ‚ç‚¹ï¼Œæ•°æ®è¯»å–æ›´åŠ çš„ä¾¿æ·</li>
<li><code>addSNTocNav</code> æ–¹æ³•å¯é’ˆå¯¹ä¸åŒçš„å±‚æ¬¡çš„é”šç‚¹åŠ å…¥æ›´å¤šä¸åŒçš„å±æ€§ï¼ˆ<code>addSNTocNav</code> ä¸ºæ ‘çš„éå†ç®—æ³•çš„ç®€åŒ–ç‰ˆï¼‰</li>
</ol>

<p>ç›¸å…³å®ç°åŸç†è¯·ç»“åˆæ³¨é‡Šä¸ä»£ç æŸ¥çœ‹ï¼ŒJavaScript å¦‚ä¸‹ï¼š</p>

<pre><code class="language-javascript">$(document).ready(function() {
     
  var navSelector=&quot;nav#TableOfContents&quot;;
  var startLevel=2;
  var endLevel=3;
  var $navigations=$(navSelector); 


  /*ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆ */
  
  var replaceHTML=extraStartTocDom(navSelector,startLevel)
  $navigations.html(replaceHTML); 
  //å¢åŠ SNåºå·()
  addSNTocNav(navSelector,startLevel,endLevel)


  $navigations.find('ul').addClass(&quot;article-toc-item-ul&quot;); 
    $navigations.find('li').addClass(&quot;article-toc-item-li&quot;); 
  });

/*
æŠ½å–å¼€å§‹å±‚æ¬¡çš„DOM
@param navSelector å¯¼èˆªæ é€‰æ‹©å™¨
@param startLevel å¼€å§‹å±‚æ¬¡
åŸºæœ¬é€»è¾‘ï¼š
ä¸»è¦æ˜¯åˆ©ç”¨äº† HTML DOM çš„èŠ‚ç‚¹å±æ€§ï¼Œåˆ©ç”¨æ ˆå¾ªç¯å°†æŸä¸ªå±‚æ¬¡çš„èŠ‚ç‚¹å…¨éƒ¨å‹å…¥å–å‡ºï¼Œæœ€åç¬¦åˆæ¡ä»¶çš„å³ä¸º DOM ç»“æ„çš„ä¸­èµ·å§‹èŠ‚ç‚¹
*/
function extraStartTocDom(navSelector,startLevel){
  var extraStack=new Array(); 
  extraStack.push($(navSelector).children(&quot;ul&quot;));

 
  for (var currentLevel = 0; currentLevel &lt;startLevel-1; currentLevel++) {
    var statckLength=extraStack.length;
    for (var index = 0; index &lt; statckLength; index++) {
      var ulTag=extraStack.shift();
      $.each($(ulTag).children(&quot;li&quot;).children('ul'), function(index, val) {
         extraStack.push($(val));
      });
    }
  } 
  
  var replaceHTML=null;
  //ç»„åˆæˆå¯¹åº”çš„HTML
  var statckLength=extraStack.length;

  replaceHTML=&quot;&lt;ul&gt;&quot;
  for (var index = 0; index &lt; statckLength; index++) {
     replaceHTML=replaceHTML+$(extraStack.shift()).html(); 
  }
  replaceHTML=replaceHTML+&quot;&lt;ul&gt;&quot;
   
  return replaceHTML;
}

/*
æŠ½å–å¼€å§‹å±‚æ¬¡çš„DOM
@param navSelector å¯¼èˆªæ é€‰æ‹©å™¨
@param startLevel å¼€å§‹å±‚æ¬¡
@param endLevel ç»“æŸå±‚æ¬¡

åŸºæœ¬é€»è¾‘ï¼š
æ•°æ®å­˜å‚¨éƒ¨åˆ†ï¼šèµ‹äºˆ&lt;ul&gt;èŠ‚ç‚¹ data-sn,data-level å±æ€§ç®¡ç†ç¼–ç ä¸æ‰€å¤„æ°´å¹³ï¼Œç±»ä¼¼æ ‘èŠ‚ç‚¹ä¸­çš„å€¼
é€»è¾‘éƒ¨åˆ†ï¼šå¼€å§‹å¾ªç¯æ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæœ¬æ¬¡å³ä¸ºæœ€å¼€å§‹çš„æ ¹èŠ‚ç‚¹ï¼‰ï¼Œå¤„ç†å½“å‰èŠ‚ç‚¹ä¸‹çš„&lt;li&gt;æ ‡ç­¾æ•°æ®ï¼Œå¦‚&lt;li&gt;æ ‡ç­¾æœ‰å­èŠ‚ç‚¹&lt;ul&gt;åˆ™èµ‹äºˆdata-sn,data-level
å€¼ï¼Œå¹¶å‹å…¥æ ˆä¸­ï¼Œç»§ç»­å¾ªç¯

*/
function addSNTocNav(navSelector,startLevel,endLevel){ 
  var tocNavStack=new Array();
  tocNavStack.push($(navSelector).children(&quot;ul&quot;));

  var currentLevel=startLevel;

  while(tocNavStack.length&gt;0){
    //å¤„ç†ç›¸å…³å…ƒç´ 
    var tocNavItem=tocNavStack.shift();
    var brotherValue=$(tocNavItem).children(&quot;li&quot;).children(&quot;a&quot;).length&gt;0?true:false;
    //brotherValue å¤„ç†ç‰¹æ®Šæƒ…å†µ  
    /**&lt;ul&gt;
       &lt;li&gt;&lt;ul&gt;&lt;/ul&gt;&lt;ul&gt;&lt;/ul&gt;&lt;/li&gt;
       &lt;li&gt;&lt;ul&gt;&lt;/ul&gt;&lt;ul&gt;&lt;/ul&gt;&lt;/li&gt;
       &lt;/ul&gt;**/

    $.each($(tocNavItem).children(&quot;li&quot;), function(index, liTag) {
      //å¤„ç†SNä¸levelæ•°æ®
      var parentTagSN=$(tocNavItem).attr(&quot;data-sn&quot;);
      var parentLevel=$(tocNavItem).attr(&quot;data-level&quot;);
      var currentTagSN=parentTagSN+&quot;.&quot;+String(index+1);
      var currentLevel=parseInt(parentLevel)+1;

      if(parentTagSN==&quot;&quot; || parentTagSN==null||parentTagSN==undefined){
        currentTagSN=String(index+1);
        currentLevel=startLevel;
      }
      
      //åŠ å…¥åºå·
      var anchorTag=$(liTag).children(&quot;a&quot;);
      $(anchorTag).text(currentTagSN+&quot; &quot;+$(anchorTag).text()); 
      //åˆ¤æ–­æ˜¯å¦æœ‰å­å…ƒç´ ï¼Œå¦‚æœ‰è®¾ç½®ç›¸å…³çš„å±æ€§
      var childULTag=$(liTag).children(&quot;ul&quot;);
      if(childULTag.length&gt;0&amp;&amp;(currentLevel&lt;=endLevel)){ 
        //å¯¹åº”brotherValueçœ‹è¯´æ˜ 
        if(brotherValue){
           $(childULTag).attr(&quot;data-sn&quot;,currentTagSN);
           $(childULTag).attr(&quot;data-level&quot;,currentLevel);
        }
        //æ¨å…¥æ ˆä¸­å¤„ç†  
        tocNavStack.push($(childULTag));
      }
      //åˆ é™¤è¶…å‡ºendLevelçš„èŠ‚ç‚¹æ•°æ®
      if(currentLevel&gt;=endLevel&amp;&amp;childULTag.length&gt;0){
        childULTag.remove();
      }
    });  
  } 
}
</code></pre>

<h3 id="css-è°ƒæ•´æ ·å¼">CSS è°ƒæ•´æ ·å¼</h3>

<p>è°ƒæ•´å Hugo TOC çš„ HTML ç»“æ„ä¸ CSS ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p>

<p><strong>HTMLä»£ç </strong></p>

<pre><code class="language-html">&lt;div class=&quot;sidebar main right&quot;&gt;
&lt;nav id=&quot;TableOfContents&quot;&gt;
 &lt;center&gt;
  ç›®å½•
 &lt;/center&gt;
 &lt;br /&gt; 
 &lt;ul class=&quot;article-toc-item-ul&quot;&gt;
  &lt;li class=&quot;article-toc-item-li&quot;&gt;&lt;a href=&quot;#ä¾§æ–¹ä½åœè½¦å°ºå¯¸åŠè¯„åˆ¤æ ‡å‡†&quot;&gt;&lt;b&gt; 1. &lt;/b&gt;ä¾§æ–¹ä½åœè½¦å°ºå¯¸åŠè¯„åˆ¤æ ‡å‡†&lt;/a&gt;&lt;/li&gt;
  &lt;li class=&quot;article-toc-item-li&quot;&gt;&lt;a href=&quot;#è€ƒè¯•æµç¨‹åŠæ“ä½œè¦ç‚¹&quot;&gt;&lt;b&gt; 2. &lt;/b&gt;è€ƒè¯•æµç¨‹åŠæ“ä½œè¦ç‚¹&lt;/a&gt;&lt;/li&gt;
 &lt;/ul&gt;
&lt;/nav&gt; 
&lt;/div&gt;

</code></pre>

<p><strong>CSSä»£ç </strong></p>

<pre><code class="language-css">.sidebar .categories-toc-item-li {
  border-bottom: 0.1em dotted;
  text-align: left;
  list-style-type: none;
  margin: 1rem auto 1rem 0rem; }
.sidebar .article-toc-item-ul {
  padding-left: 0.5rem;
  margin-left: 0.5rem;
  max-width: 99%; }
.sidebar .article-toc-item-ul .article-toc-item-li {
  border-bottom: 0.1em dotted;
  text-align: left;
  list-style-type: none; }
.sidebar .article-toc-item-ul .article-toc-item-li a {
  text-decoration: none;
  border-bottom: none;
  font-size: 0.8rem;
  padding-left: 0.5rem;
  color: #364149;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display: block;
  max-width: 99%; }
.sidebar .article-toc-item-ul .article-toc-item-li a:hover {
  font-weight: bolder;
  color: #4183c4; }
.sidebar .toc-item-scrollSync {
  border-left: 5px solid #3f51b5; }

</code></pre>

<h3 id="é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°">é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°</h3>

<p>å‚è€ƒå¾ˆå¤šçš„ Hugo åšå®¢ï¼Œå‡é‡‡ç”¨çš„å¯¼èˆªæ ä¸ºé˜…è¯»é¡µé¢ä¾§è¾¹æµ®åŠ¨æ–¹å¼ï¼Œæ„Ÿè§‰æ­¤ç±»æ–¹å¼æ¯”è¾ƒäººæ€§åŒ–ï¼Œæ‰€ä»¥åŠ å…¥æ’ä»¶ï¼š<a href="https://simple-sidebar.github.io/simpler-sidebar/">simple-siderbar</a></p>

<p>é€‰ç”¨æ­¤æ’ä»¶çš„åŸå› æ˜¯å¯¹åŸæœ‰ä»£ç ä¾µå…¥å°ï¼Œå¦‚æˆ‘çš„ <code>single.html</code> ä¾§è¾¹å¯¼èˆªæ é¡µé¢ä»£ç ä¸ºï¼š</p>

<pre><code class="language-html">&lt;div id=&quot;sidebar-main-trigger&quot; class=&quot;tableContentToc&quot;&gt;
    &lt;i class=&quot;fa fa-anchor&quot;&gt;&lt;/i&gt; 
&lt;/div&gt;

&lt;div class=&quot;sidebar main right&quot; id=&quot;sidebar-main&quot;&gt; 
  &lt;div class=&quot;wrapper&quot;&gt;  
      {{ .TableOfContents }} 
  &lt;/div&gt; 
&lt;/div&gt; 
</code></pre>

<p>å¦‚ä½¿ç”¨ <a href="https://github.com/blivesta/drawer">Drawer</a>ã€<a href="https://slideout.js.org/">slideout js</a>ï¼Œå‡å¯¹åŸæœ‰ç»“æ„éƒ½æœ‰ä¾µå…¥ï¼Œå¦‚ä¸‹</p>

<pre><code class="language-html"> &lt;header role=&quot;banner&quot;&gt;
    &lt;button type=&quot;button&quot; class=&quot;drawer-toggle drawer-hamburger&quot;&gt;
      &lt;span class=&quot;sr-only&quot;&gt;toggle navigation&lt;/span&gt;
      &lt;span class=&quot;drawer-hamburger-icon&quot;&gt;&lt;/span&gt;
    &lt;/button&gt; 
  &lt;/header&gt;

  &lt;main role=&quot;main&quot;&gt;
    &lt;!-- Page content --&gt;
    é¡µé¢éƒ¨åˆ†ä¸»ä½“
  &lt;/main&gt;
</code></pre>

<p>å…³äºå…·ä½“çš„é…ç½®ç­‰è¯·å‚è€ƒ [slideout js] çš„ demo è¿›è¡Œè°ƒè¯•</p>

<h3 id="é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥">é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥</h3>

<p>ä¸»è¦å‚è€ƒ<a href="https://orianna-zzo.github.io/sci-tech/2018-08/blogå…»æˆè®°16-è‡ªå»ºhugoçš„tocæ¨¡æ¿/">Blogå…»æˆè®°(16) è‡ªå»ºHugoçš„TOCæ¨¡æ¿</a>ï¼Œå¦‚ä¸é‡‡ç”¨bootstrap æ’ä»¶ï¼Œæ–‡ç« çš„ä»·å€¼ä¸»è¦æ˜¯åœ¨ç›‘æ§é—®é¢˜ä¸æ–‡æœ¬è¶…å‡ºé—®é¢˜å¤„ç†ã€‚</p>

<p>åŒæ­¥çš„ä¸»è¦åŸç†æ˜¯ï¼š
åˆ¤æ–­å½“å‰é¡µé¢çš„ SrollTopï¼Œä¸é”šç‚¹çš„ SrollTop æ¯”å¯¹æŸ¥æ‰¾å‡ºä¸Šä¸€ä¸ªèŠ‚ç‚¹å³å¯ï¼Œå…³é”®çš„ JavaScript ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p>

<pre><code class="language-javascript">//TOCå¯¹åº”é—®é¢˜
$(window).bind(&quot;scroll&quot;,function(){
  //åŠ å…¶ä»–å‚æ•°åŸå› ï¼š[Blogå…»æˆè®°(16) è‡ªå»ºHugoçš„TOCæ¨¡æ¿] 
  var scrollTop = $(this).scrollTop()+1+$(&quot;header[class$='site-header']&quot;).outerHeight(true);
  tocAnchorSync(&quot;a[class='TocAnchor']&quot;,scrollTop); 
});

/*
TOC å¯¼èˆªä¸é¡µé¢é”šç‚¹åŒæ­¥æ˜¾ç¤º
@param anchorSelector é”šç‚¹é€‰æ‹©å™¨
@param scrollTop æ»šåŠ¨æ ä¸é¡¶éƒ¨é«˜åº¦
*/
function tocAnchorSync(navSelector,anchorSelector,scrollTop){
  var topAnchor=null; 

  var pageAnchorAarray=$(anchorSelector);

  //åˆ¤æ–­å½“å‰ä½ç½®çš„ä¸Šä¸€ä¸ª Anchor
  $.each(pageAnchorAarray, function(index, anchor) {
      //å…ˆåˆ¤å¤„å°äºæƒ…å†µ
      if(anchor.offsetTop&lt;scrollTop){
        topAnchor=anchor;
      }
      else if(anchor.offsetTop&gt;=scrollTop&amp;&amp;topAnchor!=null){
         return false;
      }  
  }); 

   //å®šä½ç›¸å…³çš„å®šä½
  if(topAnchor!=null){
   
    var anchorID=$(topAnchor).attr(&quot;id&quot;);
    var selectorStr=&quot;a[href='#&quot;+anchorID+&quot;']&quot;;

    $(navSelector).find(&quot;a&quot;).removeClass(&quot;toc-item-scrollSync&quot;);
    $(navSelector).find(selectorStr).toggleClass(&quot;toc-item-scrollSync&quot;);
  }  
}
 
</code></pre>

<p>åŠ å…¥ <code>$(&quot;header[class$='site-header']&quot;).outerHeight(true)</code>; çš„åŸå› åœ¨äºæœ¬äººç½‘ç«™é‡‡ç”¨çš„æ˜¯å¤´éƒ¨å¯¼èˆªæ å›ºå®šæ–¹æ³•ï¼Œéœ€è¦ä¿®æ­£ç›¸å…³çš„åå·®,å…³äºåå·®è¯·å‚è€ƒæ–‡ç« <a href="https://yidaofei.com/post/20181107-js-fix-anchor-of-fixed-nav-header">JavaScript-ä¿®å¤ç”±å¯¼èˆªæ å›ºå®šå¯¼è‡´çš„é¡µé¢é”šç‚¹åå·®Bug</a></p>

<h3 id="ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ">ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ</h3>

<p>ä¸»è¦å‚è€ƒ<a href="https://orianna-zzo.github.io/sci-tech/2018-08/blogå…»æˆè®°14-è®©åŒé¡µæ»šåŠ¨æ›´å¹³æ»‘/">Blogå…»æˆè®°(14) è®©åŒé¡µæ»šåŠ¨æ›´å¹³æ»‘</a>ï¼Œ
äº†è§£åˆ° <strong>åŒé¡µæ»šåŠ¨æ›´å¹³æ»‘</strong> ä½†æ˜¯åˆä¸æƒ³ä½¿ç”¨ bootstrap 4 çš„ç›¸å…³æ’ä»¶â€”â€”ä¾µå…¥å¼å¤ªå¤§ï¼Œè®¡åˆ’åæœŸå…¨éƒ¨ç§»é™¤ï¼</p>

<p>æœ€åå®šä½ JQUERY æ’ä»¶ <a href="https://kswedberg.github.io/jquery-smooth-scroll/demo/">smooth-scroll</a>ï¼Œé€‰ä¸­çš„ç†ç”±æ˜¯è¶³å¤Ÿç®€å•
åªéœ€è¦åœ¨æœ€ååŠ ä¸€è¡Œä»£ç å³å¯ :ğŸ˜„:</p>

<pre><code class="language-javascript">&lt;!--åŠ è½½å®Œæˆåä½¿ç”¨ smooth-scroll--&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;{{ .Site.BaseURL }}/thirdParty/smooth-scroll/smooth-scroll.js&quot;&gt;&lt;/script&gt;
</code></pre>

<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3>

<p>[1]<a href="https://orianna-zzo.github.io/sci-tech/2018-08/blogå…»æˆè®°14-è®©åŒé¡µæ»šåŠ¨æ›´å¹³æ»‘/">Blogå…»æˆè®°(14) è®©åŒé¡µæ»šåŠ¨æ›´å¹³æ»‘</a><br />
[2]<a href="https://orianna-zzo.github.io/sci-tech/2018-08/blogå…»æˆè®°16-è‡ªå»ºhugoçš„tocæ¨¡æ¿/">Blogå…»æˆè®°(16) è‡ªå»ºHugoçš„TOCæ¨¡æ¿</a></p>

<h3 id="ç‰ˆæœ¬ä¿¡æ¯">ç‰ˆæœ¬ä¿¡æ¯</h3>

<table>
<thead>
<tr>
<th align="center">Version</th>
<th align="center">Action</th>
<th align="center">Time</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">1.0</td>
<td align="center">init</td>
<td align="center">2018-10-07</td>
</tr>

<tr>
<td align="center">1.1</td>
<td align="center">ä¿®å¤é‡å»º TOC åºå·é—®é¢˜</td>
<td align="center">2018-11-08</td>
</tr>
</tbody>
</table>
			  
		
		
			<div class="article-copyright">
			  	<ul>
			  		<li><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>æ˜“é“é</li>
			  		<li><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>https://yidaofei.com/post/20181107-js-rebuild-hugo-sider-toc/</li>
			  		<li><strong>ç‰ˆæƒç”³æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href='https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh'>[CC BY-NC-SA 4.0 CN ]</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
			  	</ul>
			</div>
		 
	</content>  
 	<hr/>
 	
	<div class="article-footer-meta-between"> 
		 
		<div>
			<i class="fa fa-tags">&nbsp;Tags:
			
				<a href="https://yidaofei.com/tags/hugo">hugo</a>
    		
				<a href="https://yidaofei.com/tags/jquery%e7%bb%84%e4%bb%b6">JQueryç»„ä»¶</a>
    		
				<a href="https://yidaofei.com/tags/toc">toc</a>
    		
    		</i>   
		</div> 
		 
		<div id="i-share" class="btn btn-default  share-widget">
		    <i class="fa fa-share-alt"></i>
		</div> 
	</div>
	<hr/>
	<div class="article-footer-meta-between"> 
		<div class="refArticle-prev" >
			  
		    <a href="https://yidaofei.com/post/20181013-mobile-skills-mi5s-twrp-brush/">
		    	<i class="fa fa-angle-double-left"></i>&nbsp;å°ç±³5S TWRP åˆ·æœºæ•™ç¨‹  
		    </a> 
			
		</div>
		 <div class="refArticle-next" >
		  
		  	<a href="https://yidaofei.com/post/20180920-software-skills-sublime-base-config/">Sublimeæ•™ç¨‹ï¼š ç¬¬ä¸€ç«  åŸºç¡€é…ç½®&nbsp;
		  		<i class="fa fa-angle-double-right"></i>
		  	</a> 
		 
	    </div>
	</div>  
</article> 
</section>
 

  
 
<div class="main-content-container " >
<div class="comment-card"> 
  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "yidaofeicn/comment-utterances-blog-yidaofeicn"
            issue-term="pathname"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  
</div>
</div>

 

<aside>
	
	 
	
	<div id="sidebar-main-trigger" class="tableContentToc">
	  	<i class="fa fa-anchor"></i> 
	</div>
	
	
	<span id="tocLevel" data-startLevel="" data-endLevel=""></span>

	<div class="sidebar main right" id="sidebar-main"> 
		<div class="wrapper">  
		    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#hugo-toc-åŸæœ‰æ ·å¼">Hugo TOC åŸæœ‰æ ·å¼</a></li>
<li><a href="#æ§åˆ¶-hugo-toc-å±•ç°å±‚æ¬¡">æ§åˆ¶ Hugo TOC å±•ç°å±‚æ¬¡</a>
<ul>
<li><a href="#ç¬¬ä¸€è§£å†³æ–¹æ¡ˆ-è‡ªå»ºæ•°æ®èŠ‚ç‚¹-é€’å½’ç®—æ³•">ç¬¬ä¸€è§£å†³æ–¹æ¡ˆâ€”â€”è‡ªå»ºæ•°æ®èŠ‚ç‚¹ï¼Œé€’å½’ç®—æ³•</a></li>
<li><a href="#20181108-åºå·é”™ä¹±">20181108 åºå·é”™ä¹±</a></li>
<li><a href="#ç¬¬äºŒè§£å†³æ–¹æ¡ˆ-åˆ©ç”¨-html-dom">ç¬¬äºŒè§£å†³æ–¹æ¡ˆ-åˆ©ç”¨ HTML DOM</a></li>
</ul></li>
<li><a href="#css-è°ƒæ•´æ ·å¼">CSS è°ƒæ•´æ ·å¼</a></li>
<li><a href="#é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°">é‡‡ç”¨ç‚¹å‡»å¼¹å‡ºå±‚çš„æ–¹å¼å‘ˆç°</a></li>
<li><a href="#é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥">é¡µé¢é”šç‚¹ä¸å¯¼èˆªæ åŒæ­¥</a></li>
<li><a href="#ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ">ä¼˜åŒ–é”šç‚¹è·³è½¬é¡µé¢æ»‘åŠ¨æ•ˆæœ</a></li>
<li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li>
<li><a href="#ç‰ˆæœ¬ä¿¡æ¯">ç‰ˆæœ¬ä¿¡æ¯</a></li>
</ul></li>
</ul></li>
</ul>
</nav> 
		</div> 
	</div> 
	
	  
</aside>

<footer class="site-footer text-center">
  <div class="social" > 
     
          <a href=" mailto:yidaofeicn@gmail.com "><i class="fa fa-envelope-open-o"></i></span></a>
      
       
          <a href=" https://github.com/yidaofeicn "  ><i class="fa fa-github"></i></span></a>
      
    
      
                <a href="https://yidaofei.com/index.xml" rel="noopener alternate" type="application/rss&#43;xml" target="_blank"> <i class="fa fa-rss"></i>
                </a>
          </div>
   
  <div class="copyright"  >
    Powered by &nbsp;<a href="https://gohugo.io/">Hugo</a>&nbsp;|&nbsp;
    Theme-<a href="https://github.com/yidaofeicn/hugo-theme-flybird">Flybird</a>  
  </div>
  <div class="copyright"> CopyrightÂ© 2018 Transparent Thoughts. All rights reserved.</div> 
  <div class="copyright"> 

      
    
      <span id="busuanzi_container">
        è®¿å®¢æ•°/è®¿é—®é‡ï¼š<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
      </span>
    
  </div>
</footer>

 

<div id="bottom-element" data-title="å®šä½åº•éƒ¨"></div>



<link rel="stylesheet" type="text/css" href="https://yidaofei.com//thirdParty/scrollToTopBottom/jquery.elevator.min.css">
<script type="text/javascript" src="https://yidaofei.com//thirdParty/scrollToTopBottom/jquery.elevator.min.js"></script>
 
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/3.30.0/algoliasearch.jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.32.0/autocomplete.jquery.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://yidaofei.com/thirdParty/algoliasearch/algolia-autocomplete.css">

<link rel="stylesheet" type="text/css" href="https://yidaofei.com/thirdParty/simpler-sidebar/jquery.simpler-sidebar.css"> 
<script type="text/javascript" src="https://yidaofei.com/thirdParty/simpler-sidebar/jquery.simpler-sidebar.js"></script> 

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.1/remodal-default-theme.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.1/remodal.min.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.1/remodal.min.js"></script>



<link rel="stylesheet" type="text/css" href="https://yidaofei.com//thirdParty/need-more-share2/needsharebutton.min.css">
<script type="text/javascript" src="https://yidaofei.com//thirdParty/need-more-share2/needsharebutton.min.js"></script>



<link rel="stylesheet" type="text/css" href="https://yidaofei.com//thirdParty/prismjs/prism.css">

<script type="text/javascript" src="https://yidaofei.com//thirdParty/prismjs/prism.js"></script>


<script type="text/javascript" color="#1D1D1D" opacity='1' zIndex="-2" count="400" src="https://cdnjs.cloudflare.com/ajax/libs/canvas-nest.js/2.0.3/canvas-nest.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





<span id="isPage" data-isPage="true" style="display: none;"></span>


 

<script type="text/javascript" src="https://yidaofei.com//js/flybird.js"></script> 
<script type="text/javascript" src="https://yidaofei.com//js/main.js"></script> 
  
 
</style>
</body>
</html>


 